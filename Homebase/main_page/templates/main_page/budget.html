{% extends "main_page/index.html" %}

{% block main_content %}
<div id="budget_page">
    <div id="top-part">
        <div id="overview">
            <p id="overview-text" class="h3">Overview</h3>
            <div id="saving_salary">
                <div id="salary-saving-texts" class="overview_salary_save">
                    <p class="small grey-text">Salary</p>
                    <p class="small grey-text">Savings</p>
                </div>
                <div class="overview_salary_save">
                    <input id="budget_salary" type="text" value="{{ salary }}">
                    <input id="budget_savings" type="text" value="{{ savings }}">
                </div>
            </div>
        </div>
        <div id="update">
            <div id="update-button">
                <a href="#" onclick="update_monthly_budget()">Update Week</a>
                <div class="update_monthly_loader" style="display:none"></div>
                <svg id="update_monthly_success" class="icon" style="display:none" fill="#b6cb9e" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 78.369 78.369" xml:space="preserve" stroke="#b6cb9e"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M78.049,19.015L29.458,67.606c-0.428,0.428-1.121,0.428-1.548,0L0.32,40.015c-0.427-0.426-0.427-1.119,0-1.547l6.704-6.704 c0.428-0.427,1.121-0.427,1.548,0l20.113,20.112l41.113-41.113c0.429-0.427,1.12-0.427,1.548,0l6.703,6.704 C78.477,17.894,78.477,18.586,78.049,19.015z"></path> </g> </g></svg>
            </div>
            <div id="update_date">
                <p class="small grey-text" id="last_update_date">Last update: {{ data_time }}</p>
            </div>
        </div> 
    </div>
    

    <div id="budget-modal-section" total_spending="{{ total_spending }}">
        {% for week in budget %}
        <div class="budget_modal modal" id="week_{{ week.week }}" remaining_days="{{ week.remaining_days }}">
            <p class="medium">Week {{ week.week }}</p>
            <p class="small grey-text" id="week_{{ week.week }}_dates">{{ week.dates }}</p>
            <p class="xlarge" id="week_amount_{{ week.week }}">€{{ week.amount }}</p>
        </div>
        {% endfor %}
    </div>

    <div id="spending-income-bills-section">
        <div id="spending" class="modal spending-income-bill-modal">
            <div id="spending-text">
                <p>Spending</p>
                <p class="small grey-text">2023-06</p>
                {% for spending_vector in current_month_spending.spending %}
                    <div class="spending-cat-item">
                        <img class="spending-saving-icon spending_icons" src="{{ MEDIA_URL }}{{ spending_vector.icon }}" title="{{ spending_vector.name }}">
                        <p class="spending-amount">€{{ spending_vector.amount }}</p>
                    </div>
                {% endfor %}
            </div>
            <div id="spending-graph" class="graph-div">
                <canvas id="spending-graph-canvas"></canvas>
            </div>
        </div>
        <div id="income" class="modal spending-income-bill-modal">
            <div id="income-text">
                <p>Income</p>
                <p class="small grey-text">2023-06</p>
                {% for spending_vector in current_month_spending.income %}
                    <div class="spending-cat-item">
                        <img class="spending-saving-icon income_icons" src="{{ MEDIA_URL }}{{ spending_vector.icon }}" title="{{ spending_vector.name }}">
                        <p class="income-amount">€{{ spending_vector.amount }}</p>
                    </div>
                {% endfor %}
            </div>
            <div id="income-graph" class="graph-div">
                <canvas id="income-graph-canvas"></canvas>
            </div>
        </div>
        <div id="bills" class="modal">
            <p>Upcoming Bills</p>
            <a href="#" onclick="update_bills()" class="small grey-text">Update bills</a>
            <div id="bill-check" class="small grey-text">
                <p>Remove from budget</p>
                <input id="budget-remove-checkbox" type="checkbox">
            </div>
            {% for bill in bills %}
            <div class="bill-item">
                <img class="bill-icon" src="{{ MEDIA_URL }}{{ bill.icon }}" title="{{ bill.page }}">
                <div class="bill-item-text">
                    <p class="bill-amount">€{{ bill.amount }}</p>
                    <p class="small grey-text">{{ bill.date }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

</div>
{% endblock %}